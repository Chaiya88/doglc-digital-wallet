<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª DOGLC Digital Wallet - Full Stack E2E Testing</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .test-controls {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #007bff;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(45deg, #28a745, #1e7e34);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(45deg, #ffc107, #e0a800);
            color: #212529;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .log-container {
            background: #1e1e1e;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            padding: 20px;
            border-radius: 10px;
            height: 500px;
            overflow-y: auto;
            border: 2px solid #333;
            margin-top: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #28a745, #20c997);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .status-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .status-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .status-passed { color: #28a745; }
        .status-failed { color: #dc3545; }
        .status-total { color: #007bff; }
        .status-rate { color: #6f42c1; }
        
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            border-left: 5px solid #ffc107;
        }
        
        .danger-box {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            border-left: 5px solid #dc3545;
        }
        
        .system-info {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            border-left: 5px solid #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§ª Full Stack E2E Testing</h1>
            <p>Maximum Intensity Digital Wallet System Testing</p>
        </div>
        
        <div class="content">
            <div class="warning-box">
                <strong>âš ï¸ à¸„à¸³à¹€à¸•à¸·à¸­à¸™:</strong> à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¸™à¸µà¹‰à¸ˆà¸°à¸—à¸³à¸‡à¸²à¸™à¹à¸šà¸š Maximum Intensity à¹à¸¥à¸°à¸ˆà¸°à¸—à¸”à¸ªà¸­à¸šà¸£à¸°à¸šà¸šà¹ƒà¸™à¸—à¸¸à¸à¸ªà¸ à¸²à¸§à¸° à¸£à¸§à¸¡à¸–à¸¶à¸‡ Stress Testing à¹à¸¥à¸° Security Testing à¸—à¸µà¹ˆà¸­à¸²à¸ˆà¸ªà¹ˆà¸‡à¸œà¸¥à¸à¸£à¸°à¸—à¸šà¸•à¹ˆà¸­à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸à¸‚à¸­à¸‡à¸£à¸°à¸šà¸šà¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š
            </div>
            
            <div class="system-info">
                <strong>ğŸ—ï¸ à¸‚à¹‰à¸­à¸à¸³à¸«à¸™à¸”à¸£à¸°à¸šà¸š:</strong>
                <ul>
                    <li>Frontend Worker: <code>http://127.0.0.1:8787</code></li>
                    <li>Backend API: <code>http://127.0.0.1:8788</code></li>
                    <li>Wrangler Version: 4.38.0+</li>
                    <li>Node.js Compatibility: 2024-09-23</li>
                </ul>
            </div>
            
            <div class="test-controls">
                <h3>ğŸ¯ à¸à¸²à¸£à¸„à¸§à¸šà¸„à¸¸à¸¡à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š</h3>
                
                <div class="button-group">
                    <button class="btn btn-danger" onclick="startFullStackTesting()">
                        ğŸ”¥ à¹€à¸£à¸´à¹ˆà¸¡ Full Stack E2E Testing
                    </button>
                    <button class="btn btn-primary" onclick="runSystemCheck()">
                        ğŸ—ï¸ à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸šà¸š
                    </button>
                    <button class="btn btn-warning" onclick="runStressTest()">
                        ğŸ’¥ Stress Test Only
                    </button>
                    <button class="btn btn-success" onclick="clearLog()">
                        ğŸ—‘ï¸ à¸¥à¹‰à¸²à¸‡ Log
                    </button>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
                
                <div class="status-grid">
                    <div class="status-card">
                        <div class="status-number status-total" id="totalTests">0</div>
                        <div>Total Tests</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number status-passed" id="passedTests">0</div>
                        <div>Passed</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number status-failed" id="failedTests">0</div>
                        <div>Failed</div>
                    </div>
                    <div class="status-card">
                        <div class="status-number status-rate" id="passRate">0%</div>
                        <div>Pass Rate</div>
                    </div>
                </div>
            </div>
            
            <div class="danger-box" id="testStatus" style="display: none;">
                <strong id="statusTitle">ğŸ”„ à¸à¸³à¸¥à¸±à¸‡à¹€à¸•à¸£à¸µà¸¢à¸¡à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š...</strong>
                <p id="statusMessage">à¸à¸£à¸¸à¸“à¸²à¸£à¸­à¸ªà¸±à¸à¸„à¸£à¸¹à¹ˆà¹ƒà¸™à¸‚à¸“à¸°à¸—à¸µà¹ˆà¸£à¸°à¸šà¸šà¹€à¸•à¸£à¸µà¸¢à¸¡à¸à¸£à¹‰à¸­à¸¡à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š</p>
            </div>
            
            <div class="log-container" id="testLog">
                <div>ğŸ§ª DOGLC Digital Wallet - Advanced E2E Test Suite</div>
                <div>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</div>
                <div>à¸à¸£à¹‰à¸­à¸¡à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¹à¸šà¸š Maximum Intensity</div>
                <div>à¸à¸”à¸›à¸¸à¹ˆà¸¡ "à¹€à¸£à¸´à¹ˆà¸¡ Full Stack E2E Testing" à¹€à¸à¸·à¹ˆà¸­à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™</div>
                <div></div>
                <div>ğŸ“‹ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š:</div>
                <div>1. ğŸ—ï¸ System Infrastructure Testing</div>
                <div>2. ğŸ¨ Frontend Comprehensive Testing</div>
                <div>3. ğŸ”§ Backend Intensive Testing</div>
                <div>4. ğŸ”„ E2E Integration Testing</div>
                <div>5. ğŸ’¥ Stress & Performance Testing</div>
                <div>6. ğŸ”’ Security & Resilience Testing</div>
                <div>7. ğŸš€ Deployment & Production Readiness</div>
                <div></div>
            </div>
        </div>
    </div>

    <script src="advanced-e2e-test-suite.js"></script>
    <script>
        let testSuite = null;
        let testInterval = null;
        let currentPhase = 0;
        const totalPhases = 7;

        function log(message, type = 'info') {
            const logContainer = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type === 'error' ? 'color: #ff6b6b' : 
                              type === 'success' ? 'color: #51cf66' : 
                              type === 'warning' ? 'color: #ffd43b' : 'color: #00ff00';
            
            logContainer.innerHTML += `<div style="${colorClass}">[${timestamp}] ${message}</div>`;
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function updateStatus(title, message, show = true) {
            const statusDiv = document.getElementById('testStatus');
            const titleElement = document.getElementById('statusTitle');
            const messageElement = document.getElementById('statusMessage');
            
            titleElement.textContent = title;
            messageElement.textContent = message;
            statusDiv.style.display = show ? 'block' : 'none';
        }

        function updateProgress(percentage) {
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = `${percentage}%`;
        }

        function updateTestCounts(total, passed, failed) {
            document.getElementById('totalTests').textContent = total;
            document.getElementById('passedTests').textContent = passed;
            document.getElementById('failedTests').textContent = failed;
            
            const rate = total > 0 ? ((passed / total) * 100).toFixed(1) : 0;
            document.getElementById('passRate').textContent = `${rate}%`;
        }

        async function startFullStackTesting() {
            log('ğŸ”¥ à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ Full Stack E2E Testing - Maximum Intensity Mode', 'warning');
            updateStatus('ğŸ”¥ à¸à¸³à¸¥à¸±à¸‡à¹€à¸£à¸´à¹ˆà¸¡à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š', 'à¸à¸³à¸¥à¸±à¸‡à¹€à¸•à¸£à¸µà¸¢à¸¡à¸£à¸°à¸šà¸šà¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¹à¸šà¸š Maximum Intensity...');
            
            if (!window.advancedTestSuite) {
                log('âŒ Test Suite à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸à¸£à¹‰à¸­à¸¡ à¸à¸£à¸¸à¸“à¸²à¹‚à¸«à¸¥à¸”à¸«à¸™à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆ', 'error');
                return;
            }

            // Reset counters
            currentPhase = 0;
            updateProgress(0);
            updateTestCounts(0, 0, 0);

            try {
                // Override console.log to capture test output
                const originalLog = console.log;
                console.log = function(...args) {
                    log(args.join(' '));
                    originalLog.apply(console, args);
                };

                // Override addResult method to update UI
                const originalAddResult = window.advancedTestSuite.addResult;
                window.advancedTestSuite.addResult = function(category, name, passed, message) {
                    originalAddResult.call(this, category, name, passed, message);
                    
                    // Update counters
                    const total = Object.values(this.testResults).reduce((sum, cat) => sum + cat.length, 0);
                    const totalPassed = Object.values(this.testResults).reduce((sum, cat) => 
                        sum + cat.filter(r => r.passed).length, 0);
                    const totalFailed = total - totalPassed;
                    
                    updateTestCounts(total, totalPassed, totalFailed);
                };

                // Start the test suite
                await window.advancedTestSuite.runFullStackE2E();
                
                updateStatus('âœ… à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™', 'à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¹ƒà¸™à¸ªà¹ˆà¸§à¸™ Log à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡', false);
                updateProgress(100);
                log('ğŸ‰ à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š Full Stack E2E à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™à¹à¸¥à¹‰à¸§!', 'success');

            } catch (error) {
                log(`ğŸ’¥ à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¸‚à¸“à¸°à¸—à¸”à¸ªà¸­à¸š: ${error.message}`, 'error');
                updateStatus('âŒ à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”', `Error: ${error.message}`);
            }
        }

        async function runSystemCheck() {
            log('ğŸ—ï¸ à¹€à¸£à¸´à¹ˆà¸¡à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸šà¸š...', 'info');
            updateStatus('ğŸ” à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸šà¸š', 'à¸à¸³à¸¥à¸±à¸‡à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸°à¸‚à¸­à¸‡à¸£à¸°à¸šà¸š...');

            // Test frontend
            try {
                const frontendResponse = await fetch('http://127.0.0.1:8787/');
                const frontendStatus = frontendResponse.ok ? 'âœ… à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™' : 'âŒ à¹„à¸¡à¹ˆà¸à¸£à¹‰à¸­à¸¡';
                log(`Frontend (8787): ${frontendStatus}`);
            } catch (error) {
                log('Frontend (8787): âŒ à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹„à¸”à¹‰', 'error');
            }

            // Test backend
            try {
                const backendResponse = await fetch('http://127.0.0.1:8788/');
                const backendStatus = backendResponse.ok ? 'âœ… à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™' : 'âŒ à¹„à¸¡à¹ˆà¸à¸£à¹‰à¸­à¸¡';
                log(`Backend (8788): ${backendStatus}`);
            } catch (error) {
                log('Backend (8788): âŒ à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹„à¸”à¹‰', 'error');
            }

            updateStatus('âœ… à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™', 'à¸œà¸¥à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹à¸ªà¸”à¸‡à¹ƒà¸™ Log à¹à¸¥à¹‰à¸§', false);
            log('ğŸ” à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸£à¸°à¸šà¸šà¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™', 'success');
        }

        async function runStressTest() {
            log('ğŸ’¥ à¹€à¸£à¸´à¹ˆà¸¡ Stress Test à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™...', 'warning');
            updateStatus('ğŸ’¥ à¸à¸³à¸¥à¸±à¸‡à¸—à¸³ Stress Test', 'à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¸™à¸µà¹‰à¸ˆà¸°à¸ªà¹ˆà¸‡ Request à¸ˆà¸³à¸™à¸§à¸™à¸¡à¸²à¸à¹„à¸›à¸¢à¸±à¸‡à¸£à¸°à¸šà¸š...');

            if (!window.advancedTestSuite) {
                log('âŒ Test Suite à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸à¸£à¹‰à¸­à¸¡', 'error');
                return;
            }

            try {
                await window.advancedTestSuite.runStressTests();
                updateStatus('âœ… Stress Test à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™', 'à¸œà¸¥à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¹à¸ªà¸”à¸‡à¹ƒà¸™ Log à¹à¸¥à¹‰à¸§', false);
                log('ğŸ’¥ Stress Test à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™', 'success');
            } catch (error) {
                log(`ğŸ’¥ Stress Test à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§: ${error.message}`, 'error');
                updateStatus('âŒ Stress Test à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§', error.message);
            }
        }

        function clearLog() {
            document.getElementById('testLog').innerHTML = `
                <div>ğŸ§ª DOGLC Digital Wallet - Advanced E2E Test Suite</div>
                <div>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</div>
                <div>Log à¸–à¸¹à¸à¸¥à¹‰à¸²à¸‡à¹à¸¥à¹‰à¸§ - à¸à¸£à¹‰à¸­à¸¡à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¹ƒà¸«à¸¡à¹ˆ</div>
                <div></div>
            `;
            updateTestCounts(0, 0, 0);
            updateProgress(0);
            updateStatus('ğŸ”„ à¸à¸£à¹‰à¸­à¸¡à¸—à¸”à¸ªà¸­à¸š', 'à¸£à¸°à¸šà¸šà¸à¸£à¹‰à¸­à¸¡à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¹ƒà¸«à¸¡à¹ˆ', false);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸ¯ Advanced E2E Test Suite à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™');
            log('âš¡ à¸„à¸¥à¸´à¸à¸›à¸¸à¹ˆà¸¡à¹€à¸à¸·à¹ˆà¸­à¹€à¸£à¸´à¹ˆà¸¡à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸š');
        });
    </script>
</body>
</html>